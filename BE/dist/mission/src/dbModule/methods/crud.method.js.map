{"version":3,"file":"crud.method.js","sourceRoot":"","sources":["../../../../../mission/src/dbModule/methods/crud.method.ts"],"names":[],"mappings":"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","sourcesContent":["import { LogService } from \"../../logs/logHandler\";\r\n\r\nexport class CrudMethod {\r\n  mongoModel;\r\n  logService: LogService;\r\n  constructor(mongoModel, logService?) {\r\n    this.mongoModel = mongoModel;\r\n    this.logService = logService || {\r\n      log : (log) => console.log(log),\r\n      error : (err) => console.log(err)\r\n    };\r\n  }\r\n\r\n\r\n  add(entityToAdd: any): Promise<any>   {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        this.mongoModel.create(entityToAdd, (err, entityReturn) => {\r\n          if (err) {\r\n            this.logService.error(err);\r\n            return reject(err);\r\n          }\r\n          else {\r\n            this.logService.log(\"added mission: \" + entityReturn.id);\r\n            return resolve(entityReturn);\r\n          }\r\n        });\r\n      }\r\n      catch (e) {\r\n        this.logService.error(e);\r\n        return reject(e);\r\n      }\r\n    });\r\n  }\r\n\r\n\r\n  get(entityId: any): Promise<any>  {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        this.mongoModel.findOne(entityId, (err, entityReturn) => {\r\n          if (err) {\r\n            this.logService.error(err);\r\n            return reject(err);\r\n          }\r\n          else {\r\n            if (entityReturn) {\r\n              this.logService.log(\"got mission: \" + entityReturn.id);\r\n            }\r\n            else {\r\n              this.logService.error(\"mission id:\" + entityId + \"doesn't exist\");\r\n              entityReturn = {};\r\n            }\r\n            return resolve(entityReturn);\r\n          }\r\n        });\r\n      }\r\n      catch (e) {\r\n        this.logService.error(e) ;\r\n        return reject(e);\r\n      }\r\n    });\r\n  }\r\n\r\n  getAll(): Promise<any> {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        this.mongoModel.find({}, (err, entityReturn) => {\r\n          if (err) {\r\n            this.logService.error(err);\r\n            return reject(err);\r\n          }\r\n          else {\r\n            this.logService.log(\"got all missions\");\r\n            return resolve(entityReturn);\r\n          }\r\n        });\r\n      }\r\n      catch (e) {\r\n        this.logService.error(e);\r\n        return reject(e);\r\n      }\r\n    });\r\n  }\r\n\r\n  remove(entityId: any): Promise<any>  {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        this.mongoModel.remove({_id : entityId}, (err, entityReturn) => {\r\n          if (err) {\r\n            this.logService.error(err);\r\n            return reject(err);\r\n          }\r\n          else {\r\n            this.logService.log(\"remove mission: \" + entityReturn.id);\r\n            return resolve(entityReturn);\r\n          }\r\n        });\r\n      }\r\n      catch (e) {\r\n        this.logService.error(e);\r\n        return reject(e);\r\n      }\r\n    });\r\n  }\r\n\r\n  update(updatedEntity: any): Promise<any>  {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        this.mongoModel.findByIdAndUpdate({_id: updatedEntity._id}, updatedEntity, {new: true}, (err, entityReturn) => {\r\n          if (err) {\r\n            this.logService.error(err);\r\n            return reject(err);\r\n          }\r\n          else {\r\n            this.logService.log(\"update mission: \" + entityReturn.id);\r\n            return resolve(entityReturn);\r\n          }\r\n        });\r\n      }\r\n      catch (e) {\r\n        this.logService.error(e);\r\n        return reject(e);\r\n      }\r\n    });\r\n  }\r\n\r\n  updateField(entityId, updatedField): Promise<any>  {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        this.mongoModel.findByIdAndUpdate({_id: entityId}, {\"$set\" : updatedField}, {new: true}, (err, entityReturn) => {\r\n          if (err) {\r\n            this.logService.error(err);\r\n            return reject(err);\r\n          }\r\n          else {\r\n            this.logService.log(\"update mission: \" + entityReturn.id);\r\n            return resolve(entityReturn);\r\n          }\r\n        });\r\n      }\r\n      catch (e) {\r\n        this.logService.error(e);\r\n        return reject(e);\r\n      }\r\n    });\r\n  }\r\n\r\n  removeAll() {\r\n    return new Promise((resolve, reject) => {\r\n      try {\r\n        this.mongoModel.remove({}, (err) => {\r\n          if (err) {\r\n            this.logService.error(err);\r\n            return reject(err);\r\n          }\r\n          else {\r\n            this.logService.log(\"remove all: \");\r\n            return resolve();\r\n          }\r\n        });\r\n      }\r\n      catch (e) {\r\n        this.logService.error(e);\r\n        return reject(e);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n"]}